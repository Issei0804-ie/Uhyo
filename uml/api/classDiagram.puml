@startuml

package "Domain"{
    class SessionID
    class FixedValue
    class RequestData
}

package "Usecase"{
    class websocket_repository
    class http_repository
    interface websocket_i_repository
    interface http_i_repository
}

package "controller" {
    class websocket_controller
    class http_controller
    interface context
    interface websocket
}

package "Framework" {
    /'こいつにオンメモリでデータを持たせばよさそう'/
    class Gorrila_websocket
    class gin
}


/'usecase and domain '/
RequestData <.. websocket_repository
SessionID <.. websocket_repository
SessionID <.. http_repository
FixedValue <.. http_repository

/'usecase'/
websocket_i_repository <.. websocket_repository
http_i_repository <.. http_repository

/'controller and usecase '/
http_i_repository <|. http_controller
websocket_i_repository <|. websocket_controller

/'controller'/
context <.. websocket_controller
websocket <.. websocket_controller
context <.. http_controller

/'interface and controller'/
websocket <|. Gorrila_websocket
context <|. gin
websocket_controller <.. router


/' ---------------class--------------- '/

/'domain'/
class SessionID {
    NewSessionID() *SessionID
    message string
    session_id string
}

class FixedValue {
    NewFixedValue() *FixedValue
    fixed_value string
}

class RequestData {
    request_data() *RequestData
    message string
    request_type string
    pieces []int
}

/'usecase'/
class websocket_repository {
    MatchRequest(SessionID) Error
    GameRequest(RequestData) Error
}

class http_repository{
    AuthorizeClient(FixedValue) Error, SessionID
}

interface websocket_i_repository {
    AuthorizeSessionID(SessionID) Error
}

interface http_i_repository{
    AuthorizeClient(FixedValue) Error, SessionID
}

/'controller'/
class websocket_controller {
    NewWebsocketController() *Webscoket_controller
}

interface context {
}

interface websocket {
}

/'interface'/
class Gorrila_websocket{
    GetOpponent()
}

/'etc'/
class router{
    Run()
}


/'
    "--":関連
    "<..":依存
    "o--":集約(弱い has-a 関係)
    "*--":コンポジッション(強い has-a 関係)
    "<|.":実現
    "<|-":継承
'/
@enduml

